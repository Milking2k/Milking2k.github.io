
<!DOCTYPE html>
<html lang="zh-cn">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Jelech的博客">
    <title>计算几何模板 - Jelech的博客</title>
    <meta name="author" content="Jelech">
    
        <meta name="keywords" content="博客,算法,javascript,游戏,">
    
    
        <link rel="icon" href="http://www.jelech.cn/assets/images/favicon.ico">
        <link rel="Shortcut Icon" type="image/x-icon" href="http://www.jelech.cn/assets/images/favicon.ico">
    
    
        <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Jelech","sameAs":["https://github.com/jelech","mailto"],"image":"avatar.jpg"},"articleBody":"\n\n整理了一些计算几何的模板向量基本用法123456789101112131415161718192021222324struct node &#123;      double x; // 横坐标      double y; // 纵坐标  &#125;;  typedef node Vector;Vector operator + (Vector A, Vector B) &#123; return Vector(A.x + B.x, A.y + B.y); &#125;  Vector operator - (Point A, Point B) &#123; return Vector(A.x - B.y, A.y - B.y); &#125;  Vector operator * (Vector A, double p) &#123; return Vector(A.x*p, A.y*p); &#125;  Vector operator / (Vector A, double p) &#123; return Vector(A.x / p, A.y*p); &#125;double Dot(Vector A, Vector B) &#123; return A.x*B.x + A.y*B.y; &#125; // 向量点乘  double Length(Vector A) &#123; return sqrt(Dot(A, A)); &#125;  // 向量模长  double Angle(Vector A, Vector B) &#123; return acos(Dot(A, B) / Length(A) / Length(B)); &#125;  // 向量之间夹角  double Cross(Vector A, Vector B) &#123; // 叉积计算 公式      return A.x*B.y - A.y*B.x;  &#125;  Vector Rotate(Vector A, double rad) // 向量旋转 公式  &#123;      return Vector(A.x*cos(rad) - A.y*sin(rad), A.x*sin(rad) + A.y*cos(rad));  &#125;  Point getLineIntersection(Point P, Vector v, Point Q, Vector w) &#123; // 两直线交点t1 t2计算公式       Vector u = P - Q;       double t = Cross(w, u) / Cross(v, w);  // 求得是横坐标      return P + v*t;  // 返回一个点  &#125;\n### \n求多边形面积123456789101112131415161718192021node G[maxn];  int n;  double Cross(node a, node b) &#123; // 叉积计算      return a.x*b.y - a.y*b.x;  &#125;int main()  &#123;      while (scanf(\"%d\", &amp;n) != EOF &amp;&amp; n) &#123;          for (int i = 0; i &lt; n; i++)               scanf(\"%lf %lf\", &amp;G[i].x, &amp;G[i].y);          double sum = 0;          G[n].x = G[0].x;          G[n].y = G[0].y;          for (int i = 0; i &lt; n; i++) &#123;                   sum += Cross(G[i], G[i + 1]);         &#125;          sum = sum / 2.0;          printf(\"%.1f\\n\", sum);      &#125;      return 0;  &#125;\n判断线段相交1234567891011121314151617181920212223242526272829303132333435363738394041struct Point&#123;    double x,y;    Point()&#123;&#125;    Point(double _x,double _y)&#123;x = _x;y = _y;&#125;    Point operator -(const Point &amp;b)const&#123;return Point(x - b.x,y - b.y);&#125;    double operator ^(const Point &amp;b)const&#123;return x*b.y - y*b.x;&#125;//叉积    double operator *(const Point &amp;b)const&#123;return x*b.x + y*b.y;&#125;//点积&#125;;struct Line&#123;    Point s,e;    Line()&#123;&#125;    Line(Point _s,Point _e)&#123;s = _s;e = _e;&#125;    //两直线相交求交点    //第一个值为0表示直线重合，为1表示平行，为0表示相交,为2是相交    //只有第一个值为2时，交点才有意义    pair&lt;int,Point&gt; operator &amp;(const Line &amp;b)const    &#123;        Point res = s;        if(sgn((s-e)^(b.s-b.e)) == 0)        &#123;            if(sgn((s-b.e)^(b.s-b.e)) == 0)                return make_pair(0,res);//重合            else return make_pair(1,res);//平行        &#125;        double t = ((s-b.s)^(b.s-b.e))/((s-e)^(b.s-b.e));        res.x += (e.x-s.x)*t;        res.y += (e.y-s.y)*t;        return make_pair(2,res);    &#125;&#125;;bool inter(Line l1,Line l2)&#123;    return    max(l1.s.x,l1.e.x) &gt;= min(l2.s.x,l2.e.x) &amp;&amp;    max(l2.s.x,l2.e.x) &gt;= min(l1.s.x,l1.e.x) &amp;&amp;    max(l1.s.y,l1.e.y) &gt;= min(l2.s.y,l2.e.y) &amp;&amp;    max(l2.s.y,l2.e.y) &gt;= min(l1.s.y,l1.e.y) &amp;&amp;    sgn((l2.s-l1.e)^(l1.s-l1.e))*sgn((l2.e-l1.e)^(l1.s-l1.e)) &lt;= 0 &amp;&amp;    sgn((l1.s-l2.e)^(l2.s-l2.e))*sgn((l1.e-l2.e)^(l2.s-l2.e)) &lt;= 0;&#125;\n求三角形外心123456789Point circumcenter(const Point &amp;a, const Point &amp;b, const Point &amp;c) &#123; //返回三角形的外心    Point ret;    double a1 = b.x - a.x, b1 = b.y - a.y, c1 = (a1*a1 + b1*b1) / 2;    double a2 = c.x - a.x, b2 = c.y - a.y, c2 = (a2*a2 + b2*b2) / 2;    double d = a1*b2 - a2*b1;    ret.x = a.x + (c1*b2 - c2*b1) / d;    ret.y = a.y + (a1*c2 - a2*c1) / d;    return ret;  &#125;\n极角排序123456789double cross(point p1, point p2, point q1, point q2) &#123;  // 叉积计算       return (q2.y - q1.y)*(p2.x - p1.x) - (q2.x - q1.x)*(p2.y - p1.y);  &#125;  bool cmp(point a, point b)  &#123;      point o;      o.x = o.y = 0;      return cross(o, b, o, a) &lt; 0; // 叉积判断  &#125;  sort(convex + 1, convex + cnt, cmp); // 按角排序, 从小到大\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576577578579580581582583584585586587588589590591592593594595596597598599600601602603604605606607608609610611612613614615616617618619620621622623624625626627628629630631632633634635636637638639640641642643644645646647648649650651652653654655656657658659660661662663664665666667668669670671672673674675676677678679680681682683684685686687688689690691692693694695696697698699700701702703704705706707708709710711712713714715716717718719720721722723724725726727728729730731732733734735736737738739740741742743744745746747748749750751752753754755756757758759760761762763764765766767768769770771772773774775776777778779780781782783struct Point&#123;    double x, y;    int id;    //Point(const Point&amp; rhs): x(rhs.x), y(rhs.y) &#123; &#125; //¿½±´¹¹Ôìº¯Êý    Point(double x = 0, double y = 0) : x(x), y(y) &#123; &#125;    inline void read()    &#123;        scanf(\"%lf%lf\",&amp;x,&amp;y);    &#125;    inline void print()    &#123;        printf(\"%.6lf %.6lf\\n\",x,y);    &#125;    bool operator == (const Point&amp; e) const    &#123;        return dcmp(x - e.x) == 0 &amp;&amp; dcmp(y - e.y) == 0;    &#125;    Point operator + (Point q)&#123; return Point(x+q.x,y+q.y);&#125;    Point operator - (Point q)&#123; return Point(x-q.x,y-q.y);&#125;    Point operator * (double q)&#123; return Point(x*q,y*q);&#125;    Point operator / (double q)&#123; return Point(x/q,y/q);&#125;    Point &amp;operator +=(Point q)&#123; x+=q.x;y+=q.y; return *this;&#125;    Point &amp;operator -=(Point q)&#123; x-=q.x;y-=q.y; return *this;&#125;    double operator *(const Point&amp; q) const&#123;        return x*q.x+y*q.y;    &#125;    double operator ^(const Point&amp; q) const&#123; return x*q.y-y*q.x; &#125;    double len2()&#123; return x*x+y*y; &#125;    double len()&#123; return sqrt(x*x+y*y); &#125;&#125;;//struct Circle//&#123;//    Point c;//    double r;////    Circle()&#123;&#125;//    Circle(Point c, double r):c(c), r(r)&#123;&#125;////    int input()//    &#123;//        return scanf(\"%lf%lf%lf\", &amp;c.x, &amp;c.y, &amp;r);//    &#125;////    Point point(double a)//    &#123;//        return Point(c.x + r * cos(a), c.y + r * sin(a));//    &#125;//&#125;;//struct Line&#123;//    Point P;//    Point v;////    Line()&#123;&#125;//    Line(Point P, Point v):P(P), v(v)&#123;&#125;//    bool operator==(Line z)/////    &#123;//        return (P==z.P)&amp;&amp;(v==z.v);//    &#125;//    //ax+by+c=0//    Point a,b,c;//    Line(double _a,double _b,double _c)/////    &#123;//        if (dcmp(_a)==0)//        &#123;//            a=Point(0,-_c/_b);//            b=Point(1,-_c/_b);//        &#125;//        else if (dcmp(_b)==0)//        &#123;//            a=Point(-_c/_a,0);//            b=Point(-_c/_a,1);//        &#125;//        else//        &#123;//            a=Point(0,-_c/_b);//            b=Point(1,(-_c-_a)/_b);//        &#125;//    &#125;//    int read()&#123;//        return scanf(\"%lf%lf%lf%lf\", &amp;P.x, &amp;P.y, &amp;v.x, &amp;v.y);//    &#125;////    void adjust()////    &#123;////        if (v&lt;P)swap(P,v);////    &#125;//    double angle()//直线倾斜角 0&lt;=angle&lt;180//    &#123;//        double k=atan2(v.y-P.y,v.x-P.x);/////        if (dcmp(k)&lt;0)k+=pi;//        if (dcmp(k-pi)==0)k-=pi;//        return k;//    &#125;//    Point point(double t)&#123;//        return P + v * t;//    &#125;//&#125;;bool operator &lt; (Point a, Point b) &#123; return a.x &lt; b.x || (a.x == b.x &amp;&amp; a.y &lt; b.y); &#125;bool cmp(Point p1,Point p2)//位置排序，找到最下方的；&#123;    if(p1.y!=p2.y)        return p1.y&lt;p2.y;    return p1.x&lt;p2.x;//若有多个下方的找左边的；&#125;//极角排序Point polor;bool polor_cmp(Point a,Point b)&#123;    double tmp=(a-polor)^(b-polor);    if(dcmp(tmp)==0)        return (a-polor).len()&lt;(b-polor).len();    else if(dcmp(tmp)&lt;0) return false;    else return true;&#125;typedef Point Vector;//向量点积double Dot(Vector A, Vector B) &#123; return A.x*B.x + A.y*B.y; &#125;//向量长度double Length(Vector A) &#123; return sqrt(Dot(A, A)); &#125;//向量夹角//求两向量的夹角，cos（a,b） =（ 向量a * 向量b ） / （| a | * | b |） =  x1*x2 + y1*y2 / （| a | * | b |）double Angle(Vector A, Vector B) &#123; return acos(Dot(A, B) / Length(A) / Length(B)); &#125;//向量叉积  |a||b|sin&lt;a,b&gt;//叉积的结果也是一个向量，是垂直于向量a，b所形成的平面，如果看成三维坐标的话是在 z 轴上，上面结果是它的模。double Cross(Vector A, Vector B) &#123; return A.x*B.y - A.y*B.x; &#125;//三角形有向面积的二倍double Area2(Point A, Point B, Point C) &#123; return Cross(B-A, C-A); &#125;//向量逆时针旋转rad度(弧度)Vector Rotate(Vector A, double rad) //pi/2 90°&#123;    return Vector(A.x*cos(rad)-A.y*sin(rad), A.x*sin(rad)+A.y*cos(rad));&#125;//计算向量A的单位法向量。左转90°，把长度归一。调用前确保A不是零向量。Vector Normal(Vector A)&#123;    double L = Length(A);    return Vector(-A.y/L, A.x/L);&#125;//共线或平行bool Converxline(Vector A,Vector B,Vector C,Vector D)&#123;    if((Area2(A,B,C)==0&amp;&amp;Area2(A,B,D)==0)    ||Area2(A,B,C)*Area2(A,B,D)&gt;0||Area2(C,D,A)*Area2(C,D,B)&gt;0)        return false;    else        return true;&#125;//半平面交bool on(Point a,Point b,Point p)&#123;    return fabs((a-b)^(p-b))&lt;eps;&#125;//定义圆struct Circle&#123;    Point c;    double r;    Circle() &#123;&#125;    Circle(const Circle&amp; rhs): c(rhs.c), r(rhs.r) &#123; &#125;    Circle(const Point&amp; c, const double&amp; r): c(c), r(r) &#123; &#125;    inline void input()    &#123;        scanf(\"%lf%lf%lf\",&amp;c.x,&amp;c.y,&amp;r);    &#125;    inline void print()    &#123;        printf(\"%.6lf %.6lf\\n\",c.x,c.y);    &#125;    Point point(double ang) const &#123; return Point(c.x + cos(ang)*r, c.y + sin(ang)*r); &#125; //圆心角所对应的点    double area(void) const &#123; return PI * r * r; &#125;&#125;;struct Line&#123;    Point P;    //直线上一点    Vector v; //方向向量(半平面交中该向量左侧表示相应的半平面)    double ang; //极角，即从x正半轴旋转到向量v所需要的角（弧度）    Line() &#123; &#125;  //构造函数    Line(const Line&amp; L): P(L.P), v(L.v), ang(L.ang) &#123; &#125;    Line(const Point&amp; P, const Vector&amp; v): P(P), v(v) &#123; ang = atan2(v.y, v.x); &#125;    bool operator &lt; (const Line&amp; L) const//极角排序    &#123;        return ang &lt; L.ang;    &#125;    Point point(double t) &#123; return P + v*t; &#125;&#125;;/***************************************************************************** 用直线上的一点p0和方向向量v表示一条指向。直线上的所有点P满足P = P0+t*v;* 如果知道直线上的两个点则方向向量为B-A, 所以参数方程为A+(B-A)*t;* 当t 无限制时， 该参数方程表示直线。* 当t &gt; 0时， 该参数方程表示射线。* 当 0 &lt; t &lt; 1时， 该参数方程表示线段。*****************************************************************************///直线交点,须确保两直线 P+tv 和 Q+tw 有唯一交点。当且仅当Cross(v,w)非0Point getLineCircleIntersecion(Point P, Vector v, Point Q, Vector w)&#123;    Vector u = P - Q;    double t = Cross(w, u) / Cross(v, w);    return P + v * t;&#125;/*Vector getLineCircleIntersecion(int x,int y)&#123;    Vector p1 = A[x], p2 = B[x], q1 = A[y], q2 = B[y];    return p1+(p2-p1)*(((q2-q1)^(q1-p1))/((q2-q1)^(p2-p1)));&#125;*///点和直线的关系int relation (Point p, Line l)&#123;    //1:在左侧 2:在右侧 3:在直线上    int c = dcmp (Cross (p-l.P,l.v));    if (c &lt; 0) return 1;    else if (c &gt; 0) return 2;    else return 3;&#125;//判断点在射线上bool point_on_halfline (Point p, Line l)&#123;    int id = relation (p, l);    if (id != 3) return 0;    return dcmp (Dot (p-l.P,l.v)) &gt;= 0;&#125;//点到直线距离double DistanceToLine(Point P, Point A, Point B)&#123;    Vector v1 = B - A, v2 = P - A;    return fabs(Cross(v1, v2) / Length(v1)); //不取绝对值，得到的是有向距离&#125;//点到线段的距离double DistanceToSegmentS(Point P, Point A, Point B)&#123;    if(A == B) return Length(P-A);    Vector v1 = B-A, v2 = P-A, v3 = P-B;    if(dcmp(Dot(v1, v2)) &lt; 0) return Length(v2);    else if(dcmp(Dot(v1, v3)) &gt; 0) return Length(v3);    else return fabs(Cross(v1, v2)) / Length(v1);&#125;//点在直线上的投影Point GetLineProjection(Point P, Point A, Point B)&#123;    Vector v = B - A;    return A+v*(Dot(v, P-A)/Dot(v, v));&#125;//点在直线上的投影Point GetLineProjection(Point p,Line l)&#123;    Vector v = l.v;    return l.P+v*(Dot(v, p-l.P)/Dot(v, v));&#125;//点在直线的对称点Point symmetrypoint(Point p,Line l)&#123;    Point q=GetLineProjection(p,l);    return Point(2*q.x-p.x,2*q.y-p.y);&#125;//线段相交判定，交点不在一条线段的端点bool SegmentProperIntersection(Point a1, Point a2, Point b1, Point b2)&#123;    double c1 = Cross(a2-a1, b1-a1), c2 = Cross(a2-a1, b2-a1);    double c3 = Cross(b2-b1, a1-b1), c4 = Cross(b2-b1, a2-b1);    return dcmp(c1)*dcmp(c2) &lt; 0 &amp;&amp; dcmp(c3)*dcmp(c4) &lt; 0;&#125;//判断点是否在点段上，不包含端点bool OnSegment(Point P, Point a1, Point a2)&#123;    return dcmp(Cross(a1-P, a2-P) == 0 &amp;&amp; dcmp((Dot(a1-P, a2-P)) &lt; 0));&#125;//计算凸多边形面积double ConvexPolygonArea(Point *p, int n)&#123;    double area = 0;    for(int i = 1; i &lt; n-1; i++)        area += Cross(p[i] - p[0], p[i+1] - p[0]);    return area/2;&#125;//计算多边形的有向面积double PolygonArea(Point *p, int n)&#123;    double area = 0;    for(int i = 1; i &lt; n-1; i++)        area += Cross(p[i] - p[0], p[i+1] - p[0]);    return area/2;&#125;/************************************************************************ Morley定理：三角形每个内角的三等分线，相交成的三角形是等边三角形。* 欧拉定理：设平面图的定点数，边数和面数分别为V,E,F。则V+F-E = 2;************************************************************************///Morley定理Point getD(Point A, Point B, Point C)&#123;    Vector v1=C-B;    double a1=Angle(A-B,v1);    v1=Rotate(v1,a1/3);    Vector v2=B-C;    double a2=Angle(A-C,v2);    v2=Rotate(v2,-a2/3);    return getLineCircleIntersecion(B,v1,C,v2);&#125;//欧拉定理void oula(int n)&#123;    n--;    int c=n,e=n;    for(int i=0;i&lt;n;i++)        for(int j=i+1;j&lt;n;j++)        &#123;            if(SegmentProperIntersection(P[i],[i+1],P[j],P[j+1]))            &#123;                V[c++]=getLineCircleIntersecion(P[i],P[i+1]-P[i],P[j],P[j+1]-P[j]);            &#125;        &#125;    sort(V,V+c);    c=unique(V,V+c)-V;    for(int i=0;i&lt;c;i++)        for(int j=0;j&lt;n;j++)    &#123;        if(OnSegment(V[i],P[j],p[j+1])) e++;    &#125;    //cout&lt;&lt;e+2-c&lt;&lt;endl;&#125;//直线和圆的交点，返回交点个数，结果存在sol中。//该代码没有清空sol。//(at+b)^2+(ct+d)^2=r^2; et^2+ft+g=0;int getLineCircleIntersecion(Line l, Circle C, double&amp; t1, double&amp; t2, vector&lt;Point&gt;&amp; sol)&#123;    double a = l.v.x;    double b = l.P.x - C.c.x;    double c = l.v.y;    double d = l.P.y - C.c.y;    double e = a * a + c * c;    double f = 2 * (a * b + c * d);    double g = b * b + d * d - C.r * C.r;    double delta = f * f - 4 * e * g;    double dist = DistanceToLine(C.c, l.P, l.P+l.v);    if(dcmp(dist - C.r) == 0)    &#123;      //相切，此处需特殊判断，不能用delta        t1 = t2 = -f / (2 * e);        sol.push_back(l.point(t1));        return 1;    &#125;    if(dcmp(delta) &lt; 0) return 0;       //相离    else    &#123;       //相交        t1 = (-f - sqrt(delta)) / (2 * e); sol.push_back(l.point(t1));        t2 = (-f + sqrt(delta)) / (2 * e); sol.push_back(l.point(t2));        return 2;    &#125;&#125;//计算向量极角double angle(Vector v)&#123;return atan2(v.y,v.x);&#125;//两圆相交int getCircleCircleIntersection(Circle C1, Circle C2, vector&lt;Point&gt;&amp; sol)&#123;    double d = Length(C1.c - C2.c);    if(dcmp(d) == 0)    &#123;        if(dcmp(C1.r - C2.r == 0)) return -1;    //两圆完全重合        return 0;                                //同心圆，半径不一样    &#125;    if(dcmp(C1.r + C2.r - d) &lt; 0) return 0;//外离    if(dcmp(fabs(C1.r - C2.r)- d) &gt; 0) return 0;//内含    double a = angle(C2.c - C1.c);               //向量C1C2的极角    double da = acos((C1.r*C1.r + d*d - C2.r*C2.r) / (2*C1.r*d));    //C1C2到C1P1的角    Point p1 = C1.point(a-da), p2 = C1.point(a+da);    sol.push_back(p1);    if(p1 == p2) return 1;//外切    sol.push_back(p2);    return 2;&#125;//圆和多边形相交面积//for(int i=1;i&lt;=n;i++)//    ans += TriAngleCircleInsection(C, Q[i], Q[i+1]);double TriAngleCircleInsection(Circle C, Point A, Point B)&#123;    Vector OA = A-C.c, OB = B-C.c;    Vector BA = A-B, BC = C.c-B;    Vector AB = B-A, AC = C.c-A;    double DOA = Length(OA), DOB = Length(OB),DAB = Length(AB), r = C.r;    if(dcmp(Cross(OA,OB)) == 0) return 0;    if(dcmp(DOA-C.r) &lt; 0 &amp;&amp; dcmp(DOB-C.r) &lt; 0) return Cross(OA,OB)*0.5;    else if(DOB &lt; r &amp;&amp; DOA &gt;= r)    &#123;        double x = (Dot(BA,BC) + sqrt(r*r*DAB*DAB-Cross(BA,BC)*Cross(BA,BC)))/DAB;        double TS = Cross(OA,OB)*0.5;        return asin(TS*(1-x/DAB)*2/r/DOA)*r*r*0.5+TS*x/DAB;    &#125;    else if(DOB &gt;= r &amp;&amp; DOA &lt; r)    &#123;        double y = (Dot(AB,AC)+sqrt(r*r*DAB*DAB-Cross(AB,AC)*Cross(AB,AC)))/DAB;        double TS = Cross(OA,OB)*0.5;        return asin(TS*(1-y/DAB)*2/r/DOB)*r*r*0.5+TS*y/DAB;    &#125;    else if(fabs(Cross(OA,OB)) &gt;= r*DAB || Dot(AB,AC) &lt;= 0 || Dot(BA,BC) &lt;= 0)    &#123;        if(Dot(OA,OB) &lt; 0)        &#123;            if(Cross(OA,OB) &lt; 0) return (-acos(-1.0)-asin(Cross(OA,OB)/DOA/DOB))*r*r*0.5;            else                 return ( acos(-1.0)-asin(Cross(OA,OB)/DOA/DOB))*r*r*0.5;        &#125;        else                     return asin(Cross(OA,OB)/DOA/DOB)*r*r*0.5;    &#125;    else    &#123;        double x = (Dot(BA,BC)+sqrt(r*r*DAB*DAB-Cross(BA,BC)*Cross(BA,BC)))/DAB;        double y = (Dot(AB,AC)+sqrt(r*r*DAB*DAB-Cross(AB,AC)*Cross(AB,AC)))/DAB;        double TS = Cross(OA,OB)*0.5;        return (asin(TS*(1-x/DAB)*2/r/DOA)+asin(TS*(1-y/DAB)*2/r/DOB))*r*r*0.5 + TS*((x+y)/DAB-1);    &#125;&#125;//过定点做圆的切线//过点p做圆C的切线，返回切线个数。v[i]表示第i条切线int getTangents(Point p, Circle C, Vector* v)&#123;    Vector u = C.c - p;    double dist = Length(u);    if(dist &lt; C.r) return 0;    else if(dcmp(dist - C.r) == 0)    &#123;        v[0] = Rotate(u, PI/2);        return 1;    &#125;    else    &#123;        double ang = asin(C.r / dist);        v[0] = Rotate(u, -ang);        v[1] = Rotate(u, +ang);        return 2;    &#125;&#125;//两圆位置关系判定int GetCircleLocationRelation(const Circle&amp; A, const Circle&amp; B)&#123;    double d = Length(A.c-B.c);    double sum = A.r + B.r;    double sub = fabs(A.r - B.r);    if (dcmp(d) == 0) return dcmp(sub) != 0;    if (dcmp(d - sum) &gt; 0) return XiangLi;    if (dcmp(d - sum) == 0) return WaiQie;    if (dcmp(d - sub) &gt; 0 &amp;&amp; dcmp(d - sum) &lt; 0) return INTERSECTING;    if (dcmp(d - sub) == 0) return NeiQie;    if (dcmp(d - sub) &lt; 0) return NeiHan;&#125;//两圆相交的面积double GetCircleIntersectionArea(const Circle&amp; A, const Circle&amp; B)&#123;    int rel = GetCircleLocationRelation(A, B);    if (rel &lt; INTERSECTING) return min(A.area(), B.area());    if (rel &gt; INTERSECTING) return 0;    double dis = Length(A.c - B.c);    double ang1 = acos((A.r*A.r + dis*dis - B.r*B.r) / (2.0*A.r*dis));    double ang2 = acos((B.r*B.r + dis*dis - A.r*A.r) / (2.0*B.r*dis));    return ang1*A.r*A.r + ang2*B.r*B.r - A.r*dis*sin(ang1);&#125;//三角形外接圆Circle CircumscribedCircle(Point p1,Point p2,Point p3)&#123;    double Bx=p2.x-p1.x,By=p2.y-p1.y;    double Cx=p3.x-p1.x,Cy=p3.y-p1.y;    double D=2*(Bx*Cy-By*Cx);    double cx=(Cy*(Bx*Bx+By*By)-By*(Cx*Cx+Cy*Cy))/D+p1.x;    double cy=(Bx*(Cx*Cx+Cy*Cy)-Cx*(Bx*Bx+By*By))/D+p1.y;    Point p=Point(cx,cy);//圆心    return Circle(p,Length(p1-p));//半径&#125;//三角形内接圆Circle InscribedCircle(Point p1,Point p2,Point p3)&#123;    double a=Length(p3-p2);    double b=Length(p3-p1);    double c=Length(p2-p1);    Point p=(p1*a+p2*b+p3*c)/(a+b+c);    return Circle(p,DistanceToLine(p,p2,p3));&#125;//设圆的方程为(x-a)²+(y-b)²=R²//圆上有一点(x0,y0)//则过这个点的切线为 (x-a)(x0-a)+(y-b)(y0-b)=R²//求点到圆的直线int TangentLineThroughPoint(Point p, Circle C, Vector *v)&#123;    Vector u = C.c - p;    double dist = Length(u);    if(dcmp(dist - C.r) &lt; 0) return 0;//点在圆内    else if(dcmp(dist - C.r) &lt; eps)    &#123;        v[0] = Rotate(u, pi / 2);        return 1;//点在圆上    &#125;    else    &#123;        double ang = asin(C.r / dist);//极角        v[0] = Rotate(u, ang);        v[1] = Rotate(u, -ang);        return 2;//点在圆外    &#125;&#125;void ThroughPoint(Vector *v,int cnt)&#123;    double ret[3];    for(int i=0;i&lt;cnt;i++)    &#123;        ret[i]=angle(v[i]);        if(dcmp(ret[i] - pi) == 0) ret[i] = 0;            if(dcmp(ret[i]) &lt; 0) ret[i] += pi;    &#125;    sort(ret, ret + cnt);    printf(\"[\");    for(int i = 0; i &lt; cnt; i++)    &#123;        printf(\"%.6f\", ret[i] / pi * 180);        if(cnt == 2 &amp;&amp; !i) printf(\",\");    &#125;    puts(\"]\");&#125;//求经过p1并且与一条直线相切的一组圆void CircleThroughAPointAndTangentToALineWithRadius(Point p, Point p1, Point p2, double r)&#123;    Vector AB = p2 - p1;    Vector change1 = Rotate(AB, pi / 2) / Length(AB) * r;    Vector change2 = Rotate(AB, -pi / 2) / Length(AB) * r;    Line l1(p1 + change1, AB);    Line l2(p1 + change2, AB);    vector&lt;Point&gt; sol;    sol.clear();    double t1, t2;    int cnt1 = getLineCircleIntersecion(l1, Circle(p, r), t1, t2, sol);    int cnt2 = getLineCircleIntersecion(l2, Circle(p, r), t1, t2, sol);    int cnt = cnt1 + cnt2;    if(cnt) sort(sol.begin(), sol.end());    printf(\"[\");    for(int i = 0; i &lt; cnt; i++)    &#123;        printf(\"(%.6f,%.6f)\", sol[i].x, sol[i].y);        if(cnt == 2 &amp;&amp; !i) printf(\",\");    &#125;    puts(\"]\");&#125;//给定两个向量，求两向量方向内夹着的圆的圆心。圆与两线均相切，圆的半径已给定；求圆void CircleTangentToTwoLinesWithRadius(Point A, Point B, Point C, Point D, double r)&#123;    Vector AB = B - A;    Vector change = Normal(AB) * r;    Point newA1 = A + change;    Point newA2 = A - change;    Vector CD = D - C;    Vector update = Normal(CD) * r;    Point newC1 = C + update;    Point newC2 = C - update;    Point p[5];    p[0] = getLineCircleIntersecion(newA1, AB, newC1, CD);    p[1] = getLineCircleIntersecion(newA1, AB, newC2, CD);    p[2] = getLineCircleIntersecion(newA2, AB, newC1, CD);    p[3] = getLineCircleIntersecion(newA2, AB, newC2, CD);    sort(p, p + 4);    printf(\"[\");    printf(\"(%.6f,%.6f)\", p[0].x, p[0].y);    for(int i = 1; i &lt; 4; i++)    &#123;        printf(\",(%.6f,%.6f)\", p[i].x, p[i].y);    &#125;    puts(\"]\");&#125;//给定两相离圆，求与这个两圆同时外切的圆void CircleTangentToTwoDisjointCirclesWithRadius(Circle C1, Circle C2, double r)&#123;    Vector CC = C2.c - C1.c;    double rdist = Length(CC);    if(dcmp(2 * r - rdist + C1.r + C2.r) &lt; 0) puts(\"[]\");    else if(dcmp(2 * r - rdist + C1.r + C2.r) == 0)    &#123;        double ang = angle(CC);        Point A = C1.point(ang);        Point B = C2.point(ang + pi);        Point ret = (A + B) / 2;        printf(\"[(%.6f,%.6f)]\\n\", ret.x, ret.y);    &#125;    else    &#123;        Circle A = Circle(C1.c, C1.r + r);        Circle B = Circle(C2.c, C2.r + r);        vector&lt;Point&gt; sol;        sol.clear();        getCircleCircleIntersection(A, B, sol);        sort(sol.begin(), sol.end());        printf(\"[(%.6f,%.6f),(%.6f,%.6f)]\\n\", sol[0].x, sol[0].y, sol[1].x, sol[1].y);    &#125;&#125;//三边构成三角形的判定bool check_length(double a, double b, double c)&#123;    return dcmp(a+b-c) &gt; 0 &amp;&amp; dcmp(fabs(a-b)-c) &lt; 0;&#125;bool isTriangle(double a, double b, double c)&#123;    return check_length(a, b, c) &amp;&amp; check_length(a, c, b) &amp;&amp; check_length(b, c, a);&#125;//点在三角形内部int cross(const Point &amp;a, const Point &amp;b, const Point &amp;p)&#123;    return (b.x - a.x)*(p.y - a.y) - (b.y - a.y)*(p.x - a.x);&#125;bool toLeft(const Point &amp;a, const Point &amp;b, const Point &amp;p)&#123;    return cross(a, b, p) &gt; 0;&#125;bool inTriangle(const Point &amp;p, const Point &amp;a, const Point &amp;b, const Point &amp;c)&#123;    bool res = toLeft(a, b, p);    if (res != toLeft(b, c, p))        return false;    if (res != toLeft(c, a, p))        return false;    if (cross(a, b, c) == 0)    //ABC is in one line        return false;    return true;&#125;typedef vector&lt;Point&gt; Polygon;//平行四边形的判定（保证四边形顶点按顺序给出）bool isParallelogram(Polygon p)&#123;    if (dcmp(Length(p[0]-p[1]) - Length(p[2]-p[3])) || dcmp(Length(p[0]-p[3]) - Length(p[2]-p[1]))) return false;    Line a = Line(p[0], p[1]-p[0]);    Line b = Line(p[1], p[2]-p[1]);    Line c = Line(p[3], p[2]-p[3]);    Line d = Line(p[0], p[3]-p[0]);    return dcmp(a.ang - c.ang) == 0 &amp;&amp; dcmp(b.ang - d.ang) == 0;&#125;//梯形的判定bool isTrapezium(Polygon p)&#123;    Line a = Line(p[0], p[1]-p[0]);    Line b = Line(p[1], p[2]-p[1]);    Line c = Line(p[3], p[2]-p[3]);    Line d = Line(p[0], p[3]-p[0]);    return (dcmp(a.ang - c.ang) == 0 &amp;&amp; dcmp(b.ang - d.ang)) || (dcmp(a.ang - c.ang) &amp;&amp; dcmp(b.ang - d.ang) == 0);&#125;//菱形的判定bool isRhombus(Polygon p)&#123;    if (!isParallelogram(p)) return false;    return dcmp(Length(p[1]-p[0]) - Length(p[2]-p[1])) == 0;&#125;//矩形的判定bool isRectangle(Polygon p)&#123;    if (!isParallelogram(p)) return false;    return dcmp(Length(p[2]-p[0]) - Length(p[3]-p[1])) == 0;&#125;//正方形的判定bool isSquare(Polygon p)&#123;    return isRectangle(p) &amp;&amp; isRhombus(p);&#125;//三点共线的判定bool isCollinear(Point A, Point B, Point C)&#123;    return dcmp(Cross(B-A, C-B)) == 0;&#125;//点在多边形内的判定int isPointInPolygon(Point p, Polygon poly)&#123;    int wn = 0;    int n = poly.size();    for(int i = 0; i &lt; n; i++)    &#123;        if(OnSegment(p, poly[i], poly[(i+1)%n])) return -1; //在边界上        int k = dcmp(Cross(poly[(i+1)%n]-poly[i], p-poly[i]));        int d1 = dcmp(poly[i].y - p.y);        int d2 = dcmp(poly[(i+1)%n].y - p.y);        if(k &gt; 0 &amp;&amp; d1 &lt;= 0 &amp;&amp; d2 &gt; 0) wn++;        if(k &lt; 0 &amp;&amp; d2 &lt;= 0 &amp;&amp; d1 &gt; 0) wn--;    &#125;    if(wn != 0) return 1;       //内部    return 0;                   //外部&#125;//凸包凸包的点数位ch.size();vector&lt;Point&gt; ConvexHull(vector&lt;Point&gt; p)&#123;    sort(p.begin(), p.end());    p.erase(unique(p.begin(), p.end()), p.end());    int n = p.size();    int m = 0;    vector&lt;Point&gt; ch(n+1);    for(int i = 0; i &lt; n; ++i)    &#123;        while(m &gt; 1 &amp;&amp; Cross(ch[m-1]-ch[m-2], p[i]-ch[m-2]) &lt;= 0) m--;        ch[m++] = p[i];    &#125;    int k = m;    for(int i = n-2; i &gt;= 0; --i)    &#123;        while(m &gt; k &amp;&amp; Cross(ch[m-1]-ch[m-2], p[i]-ch[m-2]) &lt;= 0) m--;        ch[m++] = p[i];    &#125;    if(m &gt; 1) m--;    ch.resize(m);    return ch;&#125;//点P在有向直线L左边的判定(线上不算)bool OnLeft(const Line&amp; L, const Point&amp; P)&#123;    return Cross(L.v, P-L.P) &gt; 0;&#125;//两直线交点，假定交点唯一存在Point GetIntersection(Line a, Line b)&#123;    Vector u = a.P - b.P;    double t = Cross(b.v, u) / Cross(a.v, b.v);    return a.P+a.v*t;&#125;int t;double x,y,r;double x_1,y_1,x_2,y_2;double x_3,y_3,x_4,y_4;int main()&#123;    return 0;&#125;\n","dateCreated":"2018-04-30T21:23:12+08:00","dateModified":"2018-12-01T21:37:41+08:00","datePublished":"2018-04-30T21:23:12+08:00","description":"","headline":"计算几何模板","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"http://www.jelech.cn/posts/56449/"},"publisher":{"@type":"Organization","name":"Jelech","sameAs":["https://github.com/jelech","mailto"],"image":"avatar.jpg","logo":{"@type":"ImageObject","url":"avatar.jpg"}},"url":"http://www.jelech.cn/posts/56449/","keywords":"算法"}</script>
    <meta name="keywords" content="算法">
<meta property="og:type" content="blog">
<meta property="og:title" content="计算几何模板">
<meta property="og:url" content="http://www.jelech.cn/posts/56449/index.html">
<meta property="og:site_name" content="Jelech的博客">
<meta property="og:locale" content="zh-cn">
<meta property="og:updated_time" content="2018-12-01T13:37:41.729Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="计算几何模板">
<meta name="twitter:creator" content="@twitter">
    
    
        
    
    
        <meta property="og:image" content="http://www.jelech.cn/assets/images/avatar.jpg"/>
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style-du2xmrqdqrl2ollgeiw050kpl6l4nbyz7bumjuurjgsxyopifvukebxc9lqe.min.css">
    <!--STYLES END-->
    

    
    <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?c3b0944d9211544bb9fe9d25ce47bac7";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="4">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/ ">Jelech的博客</a>
    </div>
    
        
            <a class="header-right-picture " href="#about">
        
        
            <img class="header-picture" src="/assets/images/avatar.jpg" alt="作者的图片">
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="4">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a href="/#about">
                    <img class="sidebar-profile-picture" src="/assets/images/avatar.jpg" alt="作者的图片">
                </a>
                <h4 class="sidebar-profile-name">Jelech</h4>
                
                    <h5 class="sidebar-profile-bio"><p>putty本无树,MinGW亦非台</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/ " title="首页">
                    
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">首页</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-categories" title="分类">
                    
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">分类</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-tags" title="标签">
                    
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">标签</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-archives" title="归档">
                    
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">归档</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/game" title="游戏">
                    
                        <i class="sidebar-button-icon fas fa-gamepad" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">游戏</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="#about" title="关于">
                    
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">关于</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="https://github.com/jelech" target="_blank" rel="noopener" title="GitHub">
                    
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/mailto" title="邮箱">
                    
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">邮箱</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="4"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            计算几何模板
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2018-04-30T21:23:12+08:00">
	
		    4月 30, 2018
    	
    </time>
    
        <span>发布在 </span>
        
    <a class="category-link" href="/categories/算法/">算法</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            
            <h1 id="table-of-contents">目录</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#整理了一些计算几何的模板"><span class="toc-text">整理了一些计算几何的模板</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#向量基本用法"><span class="toc-text">向量基本用法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#求多边形面积"><span class="toc-text">求多边形面积</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#判断线段相交"><span class="toc-text">判断线段相交</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#求三角形外心"><span class="toc-text">求三角形外心</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#极角排序"><span class="toc-text">极角排序</span></a></li></ol></li></ol>
<a id="more"></a>
<h2 id="整理了一些计算几何的模板"><a href="#整理了一些计算几何的模板" class="headerlink" title="整理了一些计算几何的模板"></a>整理了一些计算几何的模板</h2><h3 id="向量基本用法"><a href="#向量基本用法" class="headerlink" title="向量基本用法"></a>向量基本用法</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span>  </span><br><span class="line">    <span class="keyword">double</span> x; <span class="comment">// 横坐标  </span></span><br><span class="line">    <span class="keyword">double</span> y; <span class="comment">// 纵坐标  </span></span><br><span class="line">&#125;;  </span><br><span class="line"><span class="keyword">typedef</span> node Vector;</span><br><span class="line">Vector <span class="keyword">operator</span> + (Vector A, Vector B) &#123; <span class="keyword">return</span> Vector(A.x + B.x, A.y + B.y); &#125;  </span><br><span class="line">Vector <span class="keyword">operator</span> - (Point A, Point B) &#123; <span class="keyword">return</span> Vector(A.x - B.y, A.y - B.y); &#125;  </span><br><span class="line">Vector <span class="keyword">operator</span> * (Vector A, <span class="keyword">double</span> p) &#123; <span class="keyword">return</span> Vector(A.x*p, A.y*p); &#125;  </span><br><span class="line">Vector <span class="keyword">operator</span> / (Vector A, <span class="keyword">double</span> p) &#123; <span class="keyword">return</span> Vector(A.x / p, A.y*p); &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Dot</span><span class="params">(Vector A, Vector B)</span> </span>&#123; <span class="keyword">return</span> A.x*B.x + A.y*B.y; &#125; <span class="comment">// 向量点乘  </span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Length</span><span class="params">(Vector A)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">sqrt</span>(Dot(A, A)); &#125;  <span class="comment">// 向量模长  </span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Angle</span><span class="params">(Vector A, Vector B)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">acos</span>(Dot(A, B) / Length(A) / Length(B)); &#125;  <span class="comment">// 向量之间夹角  </span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Cross</span><span class="params">(Vector A, Vector B)</span> </span>&#123; <span class="comment">// 叉积计算 公式  </span></span><br><span class="line">    <span class="keyword">return</span> A.x*B.y - A.y*B.x;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="function">Vector <span class="title">Rotate</span><span class="params">(Vector A, <span class="keyword">double</span> rad)</span> <span class="comment">// 向量旋转 公式  &#123;  </span></span></span><br><span class="line"><span class="function">    <span class="keyword">return</span> <span class="title">Vector</span><span class="params">(A.x*<span class="built_in">cos</span>(rad) - A.y*<span class="built_in">sin</span>(rad), A.x*<span class="built_in">sin</span>(rad) + A.y*<span class="built_in">cos</span>(rad))</span></span>;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="function">Point <span class="title">getLineIntersection</span><span class="params">(Point P, Vector v, Point Q, Vector w)</span> </span>&#123; <span class="comment">// 两直线交点t1 t2计算公式   </span></span><br><span class="line">    Vector u = P - Q;   </span><br><span class="line">    <span class="keyword">double</span> t = Cross(w, u) / Cross(v, w);  <span class="comment">// 求得是横坐标  </span></span><br><span class="line">    <span class="keyword">return</span> P + v*t;  <span class="comment">// 返回一个点  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>### </p>
<h3 id="求多边形面积"><a href="#求多边形面积" class="headerlink" title="求多边形面积"></a>求多边形面积</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">node G[maxn];  </span><br><span class="line"><span class="keyword">int</span> n;  </span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Cross</span><span class="params">(node a, node b)</span> </span>&#123; <span class="comment">// 叉积计算  </span></span><br><span class="line">    <span class="keyword">return</span> a.x*b.y - a.y*b.x;  </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span>  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) != EOF &amp;&amp; n) &#123;  </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)   </span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%lf %lf"</span>, &amp;G[i].x, &amp;G[i].y);  </span><br><span class="line">        <span class="keyword">double</span> sum = <span class="number">0</span>;  </span><br><span class="line">        G[n].x = G[<span class="number">0</span>].x;  </span><br><span class="line">        G[n].y = G[<span class="number">0</span>].y;  </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;   </span><br><span class="line">                sum += Cross(G[i], G[i + <span class="number">1</span>]); </span><br><span class="line">        &#125;  </span><br><span class="line">        sum = sum / <span class="number">2.0</span>;  </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%.1f\n"</span>, sum);  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="判断线段相交"><a href="#判断线段相交" class="headerlink" title="判断线段相交"></a>判断线段相交</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span>&#123;</span></span><br><span class="line">    <span class="keyword">double</span> x,y;</span><br><span class="line">    Point()&#123;&#125;</span><br><span class="line">    Point(<span class="keyword">double</span> _x,<span class="keyword">double</span> _y)&#123;x = _x;y = _y;&#125;</span><br><span class="line">    Point <span class="keyword">operator</span> -(<span class="keyword">const</span> Point &amp;b)<span class="keyword">const</span>&#123;<span class="keyword">return</span> Point(x - b.x,y - b.y);&#125;</span><br><span class="line">    <span class="keyword">double</span> <span class="keyword">operator</span> ^(<span class="keyword">const</span> Point &amp;b)<span class="keyword">const</span>&#123;<span class="keyword">return</span> x*b.y - y*b.x;&#125;<span class="comment">//叉积</span></span><br><span class="line">    <span class="keyword">double</span> <span class="keyword">operator</span> *(<span class="keyword">const</span> Point &amp;b)<span class="keyword">const</span>&#123;<span class="keyword">return</span> x*b.x + y*b.y;&#125;<span class="comment">//点积</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Line</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    Point s,e;</span><br><span class="line">    Line()&#123;&#125;</span><br><span class="line">    Line(Point _s,Point _e)&#123;s = _s;e = _e;&#125;</span><br><span class="line">    <span class="comment">//两直线相交求交点</span></span><br><span class="line">    <span class="comment">//第一个值为0表示直线重合，为1表示平行，为0表示相交,为2是相交</span></span><br><span class="line">    <span class="comment">//只有第一个值为2时，交点才有意义</span></span><br><span class="line">    pair&lt;<span class="keyword">int</span>,Point&gt; <span class="keyword">operator</span> &amp;(<span class="keyword">const</span> Line &amp;b)<span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        Point res = s;</span><br><span class="line">        <span class="keyword">if</span>(sgn((s-e)^(b.s-b.e)) == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(sgn((s-b.e)^(b.s-b.e)) == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">return</span> make_pair(<span class="number">0</span>,res);<span class="comment">//重合</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">return</span> make_pair(<span class="number">1</span>,res);<span class="comment">//平行</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">double</span> t = ((s-b.s)^(b.s-b.e))/((s-e)^(b.s-b.e));</span><br><span class="line">        res.x += (e.x-s.x)*t;</span><br><span class="line">        res.y += (e.y-s.y)*t;</span><br><span class="line">        <span class="keyword">return</span> make_pair(<span class="number">2</span>,res);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">inter</span><span class="params">(Line l1,Line l2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">    max(l1.s.x,l1.e.x) &gt;= min(l2.s.x,l2.e.x) &amp;&amp;</span><br><span class="line">    max(l2.s.x,l2.e.x) &gt;= min(l1.s.x,l1.e.x) &amp;&amp;</span><br><span class="line">    max(l1.s.y,l1.e.y) &gt;= min(l2.s.y,l2.e.y) &amp;&amp;</span><br><span class="line">    max(l2.s.y,l2.e.y) &gt;= min(l1.s.y,l1.e.y) &amp;&amp;</span><br><span class="line">    sgn((l2.s-l1.e)^(l1.s-l1.e))*sgn((l2.e-l1.e)^(l1.s-l1.e)) &lt;= <span class="number">0</span> &amp;&amp;</span><br><span class="line">    sgn((l1.s-l2.e)^(l2.s-l2.e))*sgn((l1.e-l2.e)^(l2.s-l2.e)) &lt;= <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="求三角形外心"><a href="#求三角形外心" class="headerlink" title="求三角形外心"></a>求三角形外心</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Point <span class="title">circumcenter</span><span class="params">(<span class="keyword">const</span> Point &amp;a, <span class="keyword">const</span> Point &amp;b, <span class="keyword">const</span> Point &amp;c)</span> </span>&#123; <span class="comment">//返回三角形的外心</span></span><br><span class="line">    Point ret;</span><br><span class="line">    <span class="keyword">double</span> a1 = b.x - a.x, b1 = b.y - a.y, c1 = (a1*a1 + b1*b1) / <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">double</span> a2 = c.x - a.x, b2 = c.y - a.y, c2 = (a2*a2 + b2*b2) / <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">double</span> d = a1*b2 - a2*b1;</span><br><span class="line">    ret.x = a.x + (c1*b2 - c2*b1) / d;</span><br><span class="line">    ret.y = a.y + (a1*c2 - a2*c1) / d;</span><br><span class="line">    <span class="keyword">return</span> ret;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="极角排序"><a href="#极角排序" class="headerlink" title="极角排序"></a>极角排序</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">cross</span><span class="params">(point p1, point p2, point q1, point q2)</span> </span>&#123;  <span class="comment">// 叉积计算   </span></span><br><span class="line">    <span class="keyword">return</span> (q2.y - q1.y)*(p2.x - p1.x) - (q2.x - q1.x)*(p2.y - p1.y);  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(point a, point b)</span>  </span>&#123;  </span><br><span class="line">    point o;  </span><br><span class="line">    o.x = o.y = <span class="number">0</span>;  </span><br><span class="line">    <span class="keyword">return</span> cross(o, b, o, a) &lt; <span class="number">0</span>; <span class="comment">// 叉积判断  </span></span><br><span class="line">&#125;  </span><br><span class="line">sort(convex + <span class="number">1</span>, convex + cnt, cmp); <span class="comment">// 按角排序, 从小到大</span></span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">double</span> x, y;</span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    <span class="comment">//Point(const Point&amp; rhs): x(rhs.x), y(rhs.y) &#123; &#125; //¿½±´¹¹Ôìº¯Êý</span></span><br><span class="line">    Point(<span class="keyword">double</span> x = <span class="number">0</span>, <span class="keyword">double</span> y = <span class="number">0</span>) : x(x), y(y) &#123; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lf%lf"</span>,&amp;x,&amp;y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%.6lf %.6lf\n"</span>,x,y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> == (<span class="keyword">const</span> Point&amp; e) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> dcmp(x - e.x) == <span class="number">0</span> &amp;&amp; dcmp(y - e.y) == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Point <span class="keyword">operator</span> + (Point q)&#123; <span class="keyword">return</span> Point(x+q.x,y+q.y);&#125;</span><br><span class="line">    Point <span class="keyword">operator</span> - (Point q)&#123; <span class="keyword">return</span> Point(x-q.x,y-q.y);&#125;</span><br><span class="line">    Point <span class="keyword">operator</span> * (<span class="keyword">double</span> q)&#123; <span class="keyword">return</span> Point(x*q,y*q);&#125;</span><br><span class="line">    Point <span class="keyword">operator</span> / (<span class="keyword">double</span> q)&#123; <span class="keyword">return</span> Point(x/q,y/q);&#125;</span><br><span class="line">    Point &amp;<span class="keyword">operator</span> +=(Point q)&#123; x+=q.x;y+=q.y; <span class="keyword">return</span> *<span class="keyword">this</span>;&#125;</span><br><span class="line">    Point &amp;<span class="keyword">operator</span> -=(Point q)&#123; x-=q.x;y-=q.y; <span class="keyword">return</span> *<span class="keyword">this</span>;&#125;</span><br><span class="line">    <span class="keyword">double</span> <span class="keyword">operator</span> *(<span class="keyword">const</span> Point&amp; q) <span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x*q.x+y*q.y;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">double</span> <span class="keyword">operator</span> ^(<span class="keyword">const</span> Point&amp; q) <span class="keyword">const</span>&#123; <span class="keyword">return</span> x*q.y-y*q.x; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">len2</span><span class="params">()</span></span>&#123; <span class="keyword">return</span> x*x+y*y; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">len</span><span class="params">()</span></span>&#123; <span class="keyword">return</span> <span class="built_in">sqrt</span>(x*x+y*y); &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//struct Circle</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//    Point c;</span></span><br><span class="line"><span class="comment">//    double r;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//    Circle()&#123;&#125;</span></span><br><span class="line"><span class="comment">//    Circle(Point c, double r):c(c), r(r)&#123;&#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//    int input()</span></span><br><span class="line"><span class="comment">//    &#123;</span></span><br><span class="line"><span class="comment">//        return scanf("%lf%lf%lf", &amp;c.x, &amp;c.y, &amp;r);</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//    Point point(double a)</span></span><br><span class="line"><span class="comment">//    &#123;</span></span><br><span class="line"><span class="comment">//        return Point(c.x + r * cos(a), c.y + r * sin(a));</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//&#125;;</span></span><br><span class="line"><span class="comment">//struct Line&#123;</span></span><br><span class="line"><span class="comment">//    Point P;</span></span><br><span class="line"><span class="comment">//    Point v;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//    Line()&#123;&#125;</span></span><br><span class="line"><span class="comment">//    Line(Point P, Point v):P(P), v(v)&#123;&#125;</span></span><br><span class="line"><span class="comment">//    bool operator==(Line z)///</span></span><br><span class="line"><span class="comment">//    &#123;</span></span><br><span class="line"><span class="comment">//        return (P==z.P)&amp;&amp;(v==z.v);</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//    //ax+by+c=0</span></span><br><span class="line"><span class="comment">//    Point a,b,c;</span></span><br><span class="line"><span class="comment">//    Line(double _a,double _b,double _c)///</span></span><br><span class="line"><span class="comment">//    &#123;</span></span><br><span class="line"><span class="comment">//        if (dcmp(_a)==0)</span></span><br><span class="line"><span class="comment">//        &#123;</span></span><br><span class="line"><span class="comment">//            a=Point(0,-_c/_b);</span></span><br><span class="line"><span class="comment">//            b=Point(1,-_c/_b);</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"><span class="comment">//        else if (dcmp(_b)==0)</span></span><br><span class="line"><span class="comment">//        &#123;</span></span><br><span class="line"><span class="comment">//            a=Point(-_c/_a,0);</span></span><br><span class="line"><span class="comment">//            b=Point(-_c/_a,1);</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"><span class="comment">//        else</span></span><br><span class="line"><span class="comment">//        &#123;</span></span><br><span class="line"><span class="comment">//            a=Point(0,-_c/_b);</span></span><br><span class="line"><span class="comment">//            b=Point(1,(-_c-_a)/_b);</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//    int read()&#123;</span></span><br><span class="line"><span class="comment">//        return scanf("%lf%lf%lf%lf", &amp;P.x, &amp;P.y, &amp;v.x, &amp;v.y);</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">////    void adjust()</span></span><br><span class="line"><span class="comment">////    &#123;</span></span><br><span class="line"><span class="comment">////        if (v&lt;P)swap(P,v);</span></span><br><span class="line"><span class="comment">////    &#125;</span></span><br><span class="line"><span class="comment">//    double angle()//直线倾斜角 0&lt;=angle&lt;180</span></span><br><span class="line"><span class="comment">//    &#123;</span></span><br><span class="line"><span class="comment">//        double k=atan2(v.y-P.y,v.x-P.x);///</span></span><br><span class="line"><span class="comment">//        if (dcmp(k)&lt;0)k+=pi;</span></span><br><span class="line"><span class="comment">//        if (dcmp(k-pi)==0)k-=pi;</span></span><br><span class="line"><span class="comment">//        return k;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//    Point point(double t)&#123;</span></span><br><span class="line"><span class="comment">//        return P + v * t;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//&#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (Point a, Point b) &#123; <span class="keyword">return</span> a.x &lt; b.x || (a.x == b.x &amp;&amp; a.y &lt; b.y); &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(Point p1,Point p2)</span><span class="comment">//位置排序，找到最下方的；</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(p1.y!=p2.y)</span><br><span class="line">        <span class="keyword">return</span> p1.y&lt;p2.y;</span><br><span class="line">    <span class="keyword">return</span> p1.x&lt;p2.x;<span class="comment">//若有多个下方的找左边的；</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//极角排序</span></span><br><span class="line">Point polor;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">polor_cmp</span><span class="params">(Point a,Point b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> tmp=(a-polor)^(b-polor);</span><br><span class="line">    <span class="keyword">if</span>(dcmp(tmp)==<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> (a-polor).len()&lt;(b-polor).len();</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(dcmp(tmp)&lt;<span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> Point Vector;</span><br><span class="line"></span><br><span class="line"><span class="comment">//向量点积</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Dot</span><span class="params">(Vector A, Vector B)</span> </span>&#123; <span class="keyword">return</span> A.x*B.x + A.y*B.y; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//向量长度</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Length</span><span class="params">(Vector A)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">sqrt</span>(Dot(A, A)); &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//向量夹角</span></span><br><span class="line"><span class="comment">//求两向量的夹角，cos（a,b） =（ 向量a * 向量b ） / （| a | * | b |） =  x1*x2 + y1*y2 / （| a | * | b |）</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Angle</span><span class="params">(Vector A, Vector B)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">acos</span>(Dot(A, B) / Length(A) / Length(B)); &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//向量叉积  |a||b|sin&lt;a,b&gt;</span></span><br><span class="line"><span class="comment">//叉积的结果也是一个向量，是垂直于向量a，b所形成的平面，如果看成三维坐标的话是在 z 轴上，上面结果是它的模。</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Cross</span><span class="params">(Vector A, Vector B)</span> </span>&#123; <span class="keyword">return</span> A.x*B.y - A.y*B.x; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//三角形有向面积的二倍</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Area2</span><span class="params">(Point A, Point B, Point C)</span> </span>&#123; <span class="keyword">return</span> Cross(B-A, C-A); &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//向量逆时针旋转rad度(弧度)</span></span><br><span class="line"><span class="function">Vector <span class="title">Rotate</span><span class="params">(Vector A, <span class="keyword">double</span> rad)</span> <span class="comment">//pi/2 90°</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Vector(A.x*<span class="built_in">cos</span>(rad)-A.y*<span class="built_in">sin</span>(rad), A.x*<span class="built_in">sin</span>(rad)+A.y*<span class="built_in">cos</span>(rad));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//计算向量A的单位法向量。左转90°，把长度归一。调用前确保A不是零向量。</span></span><br><span class="line"><span class="function">Vector <span class="title">Normal</span><span class="params">(Vector A)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> L = Length(A);</span><br><span class="line">    <span class="keyword">return</span> Vector(-A.y/L, A.x/L);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//共线或平行</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Converxline</span><span class="params">(Vector A,Vector B,Vector C,Vector D)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>((Area2(A,B,C)==<span class="number">0</span>&amp;&amp;Area2(A,B,D)==<span class="number">0</span>)</span><br><span class="line">    ||Area2(A,B,C)*Area2(A,B,D)&gt;<span class="number">0</span>||Area2(C,D,A)*Area2(C,D,B)&gt;<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//半平面交</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">on</span><span class="params">(Point a,Point b,Point p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">fabs</span>((a-b)^(p-b))&lt;eps;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//定义圆</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Circle</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    Point c;</span><br><span class="line">    <span class="keyword">double</span> r;</span><br><span class="line">    Circle() &#123;&#125;</span><br><span class="line">    Circle(<span class="keyword">const</span> Circle&amp; rhs): c(rhs.c), r(rhs.r) &#123; &#125;</span><br><span class="line">    Circle(<span class="keyword">const</span> Point&amp; c, <span class="keyword">const</span> <span class="keyword">double</span>&amp; r): c(c), r(r) &#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">input</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lf%lf%lf"</span>,&amp;c.x,&amp;c.y,&amp;r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%.6lf %.6lf\n"</span>,c.x,c.y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Point <span class="title">point</span><span class="params">(<span class="keyword">double</span> ang)</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> Point(c.x + <span class="built_in">cos</span>(ang)*r, c.y + <span class="built_in">sin</span>(ang)*r); &#125; <span class="comment">//圆心角所对应的点</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">area</span><span class="params">(<span class="keyword">void</span>)</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> PI * r * r; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Line</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    Point P;    <span class="comment">//直线上一点</span></span><br><span class="line">    Vector v; <span class="comment">//方向向量(半平面交中该向量左侧表示相应的半平面)</span></span><br><span class="line">    <span class="keyword">double</span> ang; <span class="comment">//极角，即从x正半轴旋转到向量v所需要的角（弧度）</span></span><br><span class="line">    Line() &#123; &#125;  <span class="comment">//构造函数</span></span><br><span class="line">    Line(<span class="keyword">const</span> Line&amp; L): P(L.P), v(L.v), ang(L.ang) &#123; &#125;</span><br><span class="line">    Line(<span class="keyword">const</span> Point&amp; P, <span class="keyword">const</span> Vector&amp; v): P(P), v(v) &#123; ang = <span class="built_in">atan2</span>(v.y, v.x); &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Line&amp; L) <span class="keyword">const</span><span class="comment">//极角排序</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> ang &lt; L.ang;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Point <span class="title">point</span><span class="params">(<span class="keyword">double</span> t)</span> </span>&#123; <span class="keyword">return</span> P + v*t; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/****************************************************************************</span></span><br><span class="line"><span class="comment">* 用直线上的一点p0和方向向量v表示一条指向。直线上的所有点P满足P = P0+t*v;</span></span><br><span class="line"><span class="comment">* 如果知道直线上的两个点则方向向量为B-A, 所以参数方程为A+(B-A)*t;</span></span><br><span class="line"><span class="comment">* 当t 无限制时， 该参数方程表示直线。</span></span><br><span class="line"><span class="comment">* 当t &gt; 0时， 该参数方程表示射线。</span></span><br><span class="line"><span class="comment">* 当 0 &lt; t &lt; 1时， 该参数方程表示线段。</span></span><br><span class="line"><span class="comment">*****************************************************************************/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//直线交点,须确保两直线 P+tv 和 Q+tw 有唯一交点。当且仅当Cross(v,w)非0</span></span><br><span class="line"><span class="function">Point <span class="title">getLineCircleIntersecion</span><span class="params">(Point P, Vector v, Point Q, Vector w)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Vector u = P - Q;</span><br><span class="line">    <span class="keyword">double</span> t = Cross(w, u) / Cross(v, w);</span><br><span class="line">    <span class="keyword">return</span> P + v * t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Vector getLineCircleIntersecion(int x,int y)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    Vector p1 = A[x], p2 = B[x], q1 = A[y], q2 = B[y];</span></span><br><span class="line"><span class="comment">    return p1+(p2-p1)*(((q2-q1)^(q1-p1))/((q2-q1)^(p2-p1)));</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">//点和直线的关系</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">relation</span> <span class="params">(Point p, Line l)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//1:在左侧 2:在右侧 3:在直线上</span></span><br><span class="line">    <span class="keyword">int</span> c = dcmp (Cross (p-l.P,l.v));</span><br><span class="line">    <span class="keyword">if</span> (c &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (c &gt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//判断点在射线上</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">point_on_halfline</span> <span class="params">(Point p, Line l)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> id = relation (p, l);</span><br><span class="line">    <span class="keyword">if</span> (id != <span class="number">3</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> dcmp (Dot (p-l.P,l.v)) &gt;= <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//点到直线距离</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">DistanceToLine</span><span class="params">(Point P, Point A, Point B)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Vector v1 = B - A, v2 = P - A;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">fabs</span>(Cross(v1, v2) / Length(v1)); <span class="comment">//不取绝对值，得到的是有向距离</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//点到线段的距离</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">DistanceToSegmentS</span><span class="params">(Point P, Point A, Point B)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(A == B) <span class="keyword">return</span> Length(P-A);</span><br><span class="line">    Vector v1 = B-A, v2 = P-A, v3 = P-B;</span><br><span class="line">    <span class="keyword">if</span>(dcmp(Dot(v1, v2)) &lt; <span class="number">0</span>) <span class="keyword">return</span> Length(v2);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(dcmp(Dot(v1, v3)) &gt; <span class="number">0</span>) <span class="keyword">return</span> Length(v3);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">fabs</span>(Cross(v1, v2)) / Length(v1);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//点在直线上的投影</span></span><br><span class="line"><span class="function">Point <span class="title">GetLineProjection</span><span class="params">(Point P, Point A, Point B)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Vector v = B - A;</span><br><span class="line">    <span class="keyword">return</span> A+v*(Dot(v, P-A)/Dot(v, v));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//点在直线上的投影</span></span><br><span class="line"><span class="function">Point <span class="title">GetLineProjection</span><span class="params">(Point p,Line l)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Vector v = l.v;</span><br><span class="line">    <span class="keyword">return</span> l.P+v*(Dot(v, p-l.P)/Dot(v, v));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//点在直线的对称点</span></span><br><span class="line"><span class="function">Point <span class="title">symmetrypoint</span><span class="params">(Point p,Line l)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Point q=GetLineProjection(p,l);</span><br><span class="line">    <span class="keyword">return</span> Point(<span class="number">2</span>*q.x-p.x,<span class="number">2</span>*q.y-p.y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//线段相交判定，交点不在一条线段的端点</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">SegmentProperIntersection</span><span class="params">(Point a1, Point a2, Point b1, Point b2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> c1 = Cross(a2-a1, b1-a1), c2 = Cross(a2-a1, b2-a1);</span><br><span class="line">    <span class="keyword">double</span> c3 = Cross(b2-b1, a1-b1), c4 = Cross(b2-b1, a2-b1);</span><br><span class="line">    <span class="keyword">return</span> dcmp(c1)*dcmp(c2) &lt; <span class="number">0</span> &amp;&amp; dcmp(c3)*dcmp(c4) &lt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//判断点是否在点段上，不包含端点</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">OnSegment</span><span class="params">(Point P, Point a1, Point a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> dcmp(Cross(a1-P, a2-P) == <span class="number">0</span> &amp;&amp; dcmp((Dot(a1-P, a2-P)) &lt; <span class="number">0</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//计算凸多边形面积</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">ConvexPolygonArea</span><span class="params">(Point *p, <span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> area = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n<span class="number">-1</span>; i++)</span><br><span class="line">        area += Cross(p[i] - p[<span class="number">0</span>], p[i+<span class="number">1</span>] - p[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">return</span> area/<span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//计算多边形的有向面积</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">PolygonArea</span><span class="params">(Point *p, <span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> area = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n<span class="number">-1</span>; i++)</span><br><span class="line">        area += Cross(p[i] - p[<span class="number">0</span>], p[i+<span class="number">1</span>] - p[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">return</span> area/<span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/***********************************************************************</span></span><br><span class="line"><span class="comment">* Morley定理：三角形每个内角的三等分线，相交成的三角形是等边三角形。</span></span><br><span class="line"><span class="comment">* 欧拉定理：设平面图的定点数，边数和面数分别为V,E,F。则V+F-E = 2;</span></span><br><span class="line"><span class="comment">************************************************************************/</span></span><br><span class="line"><span class="comment">//Morley定理</span></span><br><span class="line"><span class="function">Point <span class="title">getD</span><span class="params">(Point A, Point B, Point C)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Vector v1=C-B;</span><br><span class="line">    <span class="keyword">double</span> a1=Angle(A-B,v1);</span><br><span class="line">    v1=Rotate(v1,a1/<span class="number">3</span>);</span><br><span class="line">    Vector v2=B-C;</span><br><span class="line">    <span class="keyword">double</span> a2=Angle(A-C,v2);</span><br><span class="line">    v2=Rotate(v2,-a2/<span class="number">3</span>);</span><br><span class="line">    <span class="keyword">return</span> getLineCircleIntersecion(B,v1,C,v2);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//欧拉定理</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">oula</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    n--;</span><br><span class="line">    <span class="keyword">int</span> c=n,e=n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=i+<span class="number">1</span>;j&lt;n;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(SegmentProperIntersection(P[i],[i+<span class="number">1</span>],P[j],P[j+<span class="number">1</span>]))</span><br><span class="line">            &#123;</span><br><span class="line">                V[c++]=getLineCircleIntersecion(P[i],P[i+<span class="number">1</span>]-P[i],P[j],P[j+<span class="number">1</span>]-P[j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    sort(V,V+c);</span><br><span class="line">    c=unique(V,V+c)-V;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;c;i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;n;j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(OnSegment(V[i],P[j],p[j+<span class="number">1</span>])) e++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//cout&lt;&lt;e+2-c&lt;&lt;endl;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//直线和圆的交点，返回交点个数，结果存在sol中。</span></span><br><span class="line"><span class="comment">//该代码没有清空sol。</span></span><br><span class="line"><span class="comment">//(at+b)^2+(ct+d)^2=r^2; et^2+ft+g=0;</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getLineCircleIntersecion</span><span class="params">(Line l, Circle C, <span class="keyword">double</span>&amp; t1, <span class="keyword">double</span>&amp; t2, <span class="built_in">vector</span>&lt;Point&gt;&amp; sol)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> a = l.v.x;</span><br><span class="line">    <span class="keyword">double</span> b = l.P.x - C.c.x;</span><br><span class="line">    <span class="keyword">double</span> c = l.v.y;</span><br><span class="line">    <span class="keyword">double</span> d = l.P.y - C.c.y;</span><br><span class="line">    <span class="keyword">double</span> e = a * a + c * c;</span><br><span class="line">    <span class="keyword">double</span> f = <span class="number">2</span> * (a * b + c * d);</span><br><span class="line">    <span class="keyword">double</span> g = b * b + d * d - C.r * C.r;</span><br><span class="line">    <span class="keyword">double</span> delta = f * f - <span class="number">4</span> * e * g;</span><br><span class="line">    <span class="keyword">double</span> dist = DistanceToLine(C.c, l.P, l.P+l.v);</span><br><span class="line">    <span class="keyword">if</span>(dcmp(dist - C.r) == <span class="number">0</span>)</span><br><span class="line">    &#123;      <span class="comment">//相切，此处需特殊判断，不能用delta</span></span><br><span class="line">        t1 = t2 = -f / (<span class="number">2</span> * e);</span><br><span class="line">        sol.push_back(l.point(t1));</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(dcmp(delta) &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;       <span class="comment">//相离</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;       <span class="comment">//相交</span></span><br><span class="line">        t1 = (-f - <span class="built_in">sqrt</span>(delta)) / (<span class="number">2</span> * e); sol.push_back(l.point(t1));</span><br><span class="line">        t2 = (-f + <span class="built_in">sqrt</span>(delta)) / (<span class="number">2</span> * e); sol.push_back(l.point(t2));</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//计算向量极角</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">angle</span><span class="params">(Vector v)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">atan2</span>(v.y,v.x);&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//两圆相交</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getCircleCircleIntersection</span><span class="params">(Circle C1, Circle C2, <span class="built_in">vector</span>&lt;Point&gt;&amp; sol)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> d = Length(C1.c - C2.c);</span><br><span class="line">    <span class="keyword">if</span>(dcmp(d) == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(dcmp(C1.r - C2.r == <span class="number">0</span>)) <span class="keyword">return</span> <span class="number">-1</span>;    <span class="comment">//两圆完全重合</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;                                <span class="comment">//同心圆，半径不一样</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(dcmp(C1.r + C2.r - d) &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;<span class="comment">//外离</span></span><br><span class="line">    <span class="keyword">if</span>(dcmp(<span class="built_in">fabs</span>(C1.r - C2.r)- d) &gt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;<span class="comment">//内含</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">double</span> a = angle(C2.c - C1.c);               <span class="comment">//向量C1C2的极角</span></span><br><span class="line">    <span class="keyword">double</span> da = <span class="built_in">acos</span>((C1.r*C1.r + d*d - C2.r*C2.r) / (<span class="number">2</span>*C1.r*d));</span><br><span class="line">    <span class="comment">//C1C2到C1P1的角</span></span><br><span class="line">    Point p1 = C1.point(a-da), p2 = C1.point(a+da);</span><br><span class="line">    sol.push_back(p1);</span><br><span class="line">    <span class="keyword">if</span>(p1 == p2) <span class="keyword">return</span> <span class="number">1</span>;<span class="comment">//外切</span></span><br><span class="line">    sol.push_back(p2);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//圆和多边形相交面积</span></span><br><span class="line"><span class="comment">//for(int i=1;i&lt;=n;i++)</span></span><br><span class="line"><span class="comment">//    ans += TriAngleCircleInsection(C, Q[i], Q[i+1]);</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">TriAngleCircleInsection</span><span class="params">(Circle C, Point A, Point B)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Vector OA = A-C.c, OB = B-C.c;</span><br><span class="line">    Vector BA = A-B, BC = C.c-B;</span><br><span class="line">    Vector AB = B-A, AC = C.c-A;</span><br><span class="line">    <span class="keyword">double</span> DOA = Length(OA), DOB = Length(OB),DAB = Length(AB), r = C.r;</span><br><span class="line">    <span class="keyword">if</span>(dcmp(Cross(OA,OB)) == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(dcmp(DOA-C.r) &lt; <span class="number">0</span> &amp;&amp; dcmp(DOB-C.r) &lt; <span class="number">0</span>) <span class="keyword">return</span> Cross(OA,OB)*<span class="number">0.5</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(DOB &lt; r &amp;&amp; DOA &gt;= r)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">double</span> x = (Dot(BA,BC) + <span class="built_in">sqrt</span>(r*r*DAB*DAB-Cross(BA,BC)*Cross(BA,BC)))/DAB;</span><br><span class="line">        <span class="keyword">double</span> TS = Cross(OA,OB)*<span class="number">0.5</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">asin</span>(TS*(<span class="number">1</span>-x/DAB)*<span class="number">2</span>/r/DOA)*r*r*<span class="number">0.5</span>+TS*x/DAB;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(DOB &gt;= r &amp;&amp; DOA &lt; r)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">double</span> y = (Dot(AB,AC)+<span class="built_in">sqrt</span>(r*r*DAB*DAB-Cross(AB,AC)*Cross(AB,AC)))/DAB;</span><br><span class="line">        <span class="keyword">double</span> TS = Cross(OA,OB)*<span class="number">0.5</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">asin</span>(TS*(<span class="number">1</span>-y/DAB)*<span class="number">2</span>/r/DOB)*r*r*<span class="number">0.5</span>+TS*y/DAB;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">fabs</span>(Cross(OA,OB)) &gt;= r*DAB || Dot(AB,AC) &lt;= <span class="number">0</span> || Dot(BA,BC) &lt;= <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(Dot(OA,OB) &lt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(Cross(OA,OB) &lt; <span class="number">0</span>) <span class="keyword">return</span> (-<span class="built_in">acos</span>(<span class="number">-1.0</span>)-<span class="built_in">asin</span>(Cross(OA,OB)/DOA/DOB))*r*r*<span class="number">0.5</span>;</span><br><span class="line">            <span class="keyword">else</span>                 <span class="keyword">return</span> ( <span class="built_in">acos</span>(<span class="number">-1.0</span>)-<span class="built_in">asin</span>(Cross(OA,OB)/DOA/DOB))*r*r*<span class="number">0.5</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>                     <span class="keyword">return</span> <span class="built_in">asin</span>(Cross(OA,OB)/DOA/DOB)*r*r*<span class="number">0.5</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">double</span> x = (Dot(BA,BC)+<span class="built_in">sqrt</span>(r*r*DAB*DAB-Cross(BA,BC)*Cross(BA,BC)))/DAB;</span><br><span class="line">        <span class="keyword">double</span> y = (Dot(AB,AC)+<span class="built_in">sqrt</span>(r*r*DAB*DAB-Cross(AB,AC)*Cross(AB,AC)))/DAB;</span><br><span class="line">        <span class="keyword">double</span> TS = Cross(OA,OB)*<span class="number">0.5</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">asin</span>(TS*(<span class="number">1</span>-x/DAB)*<span class="number">2</span>/r/DOA)+<span class="built_in">asin</span>(TS*(<span class="number">1</span>-y/DAB)*<span class="number">2</span>/r/DOB))*r*r*<span class="number">0.5</span> + TS*((x+y)/DAB<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//过定点做圆的切线</span></span><br><span class="line"><span class="comment">//过点p做圆C的切线，返回切线个数。v[i]表示第i条切线</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getTangents</span><span class="params">(Point p, Circle C, Vector* v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Vector u = C.c - p;</span><br><span class="line">    <span class="keyword">double</span> dist = Length(u);</span><br><span class="line">    <span class="keyword">if</span>(dist &lt; C.r) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(dcmp(dist - C.r) == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        v[<span class="number">0</span>] = Rotate(u, PI/<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">double</span> ang = <span class="built_in">asin</span>(C.r / dist);</span><br><span class="line">        v[<span class="number">0</span>] = Rotate(u, -ang);</span><br><span class="line">        v[<span class="number">1</span>] = Rotate(u, +ang);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//两圆位置关系判定</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">GetCircleLocationRelation</span><span class="params">(<span class="keyword">const</span> Circle&amp; A, <span class="keyword">const</span> Circle&amp; B)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> d = Length(A.c-B.c);</span><br><span class="line">    <span class="keyword">double</span> sum = A.r + B.r;</span><br><span class="line">    <span class="keyword">double</span> sub = <span class="built_in">fabs</span>(A.r - B.r);</span><br><span class="line">    <span class="keyword">if</span> (dcmp(d) == <span class="number">0</span>) <span class="keyword">return</span> dcmp(sub) != <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (dcmp(d - sum) &gt; <span class="number">0</span>) <span class="keyword">return</span> XiangLi;</span><br><span class="line">    <span class="keyword">if</span> (dcmp(d - sum) == <span class="number">0</span>) <span class="keyword">return</span> WaiQie;</span><br><span class="line">    <span class="keyword">if</span> (dcmp(d - sub) &gt; <span class="number">0</span> &amp;&amp; dcmp(d - sum) &lt; <span class="number">0</span>) <span class="keyword">return</span> INTERSECTING;</span><br><span class="line">    <span class="keyword">if</span> (dcmp(d - sub) == <span class="number">0</span>) <span class="keyword">return</span> NeiQie;</span><br><span class="line">    <span class="keyword">if</span> (dcmp(d - sub) &lt; <span class="number">0</span>) <span class="keyword">return</span> NeiHan;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//两圆相交的面积</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">GetCircleIntersectionArea</span><span class="params">(<span class="keyword">const</span> Circle&amp; A, <span class="keyword">const</span> Circle&amp; B)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> rel = GetCircleLocationRelation(A, B);</span><br><span class="line">    <span class="keyword">if</span> (rel &lt; INTERSECTING) <span class="keyword">return</span> min(A.area(), B.area());</span><br><span class="line">    <span class="keyword">if</span> (rel &gt; INTERSECTING) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">double</span> dis = Length(A.c - B.c);</span><br><span class="line">    <span class="keyword">double</span> ang1 = <span class="built_in">acos</span>((A.r*A.r + dis*dis - B.r*B.r) / (<span class="number">2.0</span>*A.r*dis));</span><br><span class="line">    <span class="keyword">double</span> ang2 = <span class="built_in">acos</span>((B.r*B.r + dis*dis - A.r*A.r) / (<span class="number">2.0</span>*B.r*dis));</span><br><span class="line">    <span class="keyword">return</span> ang1*A.r*A.r + ang2*B.r*B.r - A.r*dis*<span class="built_in">sin</span>(ang1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//三角形外接圆</span></span><br><span class="line"><span class="function">Circle <span class="title">CircumscribedCircle</span><span class="params">(Point p1,Point p2,Point p3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> Bx=p2.x-p1.x,By=p2.y-p1.y;</span><br><span class="line">    <span class="keyword">double</span> Cx=p3.x-p1.x,Cy=p3.y-p1.y;</span><br><span class="line">    <span class="keyword">double</span> D=<span class="number">2</span>*(Bx*Cy-By*Cx);</span><br><span class="line">    <span class="keyword">double</span> cx=(Cy*(Bx*Bx+By*By)-By*(Cx*Cx+Cy*Cy))/D+p1.x;</span><br><span class="line">    <span class="keyword">double</span> cy=(Bx*(Cx*Cx+Cy*Cy)-Cx*(Bx*Bx+By*By))/D+p1.y;</span><br><span class="line">    Point p=Point(cx,cy);<span class="comment">//圆心</span></span><br><span class="line">    <span class="keyword">return</span> Circle(p,Length(p1-p));<span class="comment">//半径</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//三角形内接圆</span></span><br><span class="line"><span class="function">Circle <span class="title">InscribedCircle</span><span class="params">(Point p1,Point p2,Point p3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> a=Length(p3-p2);</span><br><span class="line">    <span class="keyword">double</span> b=Length(p3-p1);</span><br><span class="line">    <span class="keyword">double</span> c=Length(p2-p1);</span><br><span class="line">    Point p=(p1*a+p2*b+p3*c)/(a+b+c);</span><br><span class="line">    <span class="keyword">return</span> Circle(p,DistanceToLine(p,p2,p3));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//设圆的方程为(x-a)²+(y-b)²=R²</span></span><br><span class="line"><span class="comment">//圆上有一点(x0,y0)</span></span><br><span class="line"><span class="comment">//则过这个点的切线为 (x-a)(x0-a)+(y-b)(y0-b)=R²</span></span><br><span class="line"><span class="comment">//求点到圆的直线</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">TangentLineThroughPoint</span><span class="params">(Point p, Circle C, Vector *v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Vector u = C.c - p;</span><br><span class="line">    <span class="keyword">double</span> dist = Length(u);</span><br><span class="line">    <span class="keyword">if</span>(dcmp(dist - C.r) &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;<span class="comment">//点在圆内</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(dcmp(dist - C.r) &lt; eps)</span><br><span class="line">    &#123;</span><br><span class="line">        v[<span class="number">0</span>] = Rotate(u, pi / <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;<span class="comment">//点在圆上</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">double</span> ang = <span class="built_in">asin</span>(C.r / dist);<span class="comment">//极角</span></span><br><span class="line">        v[<span class="number">0</span>] = Rotate(u, ang);</span><br><span class="line">        v[<span class="number">1</span>] = Rotate(u, -ang);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;<span class="comment">//点在圆外</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ThroughPoint</span><span class="params">(Vector *v,<span class="keyword">int</span> cnt)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> ret[<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;cnt;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ret[i]=angle(v[i]);</span><br><span class="line">        <span class="keyword">if</span>(dcmp(ret[i] - pi) == <span class="number">0</span>) ret[i] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span>(dcmp(ret[i]) &lt; <span class="number">0</span>) ret[i] += pi;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(ret, ret + cnt);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"["</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%.6f"</span>, ret[i] / pi * <span class="number">180</span>);</span><br><span class="line">        <span class="keyword">if</span>(cnt == <span class="number">2</span> &amp;&amp; !i) <span class="built_in">printf</span>(<span class="string">","</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"]"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//求经过p1并且与一条直线相切的一组圆</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CircleThroughAPointAndTangentToALineWithRadius</span><span class="params">(Point p, Point p1, Point p2, <span class="keyword">double</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Vector AB = p2 - p1;</span><br><span class="line">    Vector change1 = Rotate(AB, pi / <span class="number">2</span>) / Length(AB) * r;</span><br><span class="line">    Vector change2 = Rotate(AB, -pi / <span class="number">2</span>) / Length(AB) * r;</span><br><span class="line">    <span class="function">Line <span class="title">l1</span><span class="params">(p1 + change1, AB)</span></span>;</span><br><span class="line">    <span class="function">Line <span class="title">l2</span><span class="params">(p1 + change2, AB)</span></span>;</span><br><span class="line">    <span class="built_in">vector</span>&lt;Point&gt; sol;</span><br><span class="line">    sol.clear();</span><br><span class="line">    <span class="keyword">double</span> t1, t2;</span><br><span class="line">    <span class="keyword">int</span> cnt1 = getLineCircleIntersecion(l1, Circle(p, r), t1, t2, sol);</span><br><span class="line">    <span class="keyword">int</span> cnt2 = getLineCircleIntersecion(l2, Circle(p, r), t1, t2, sol);</span><br><span class="line">    <span class="keyword">int</span> cnt = cnt1 + cnt2;</span><br><span class="line">    <span class="keyword">if</span>(cnt) sort(sol.begin(), sol.end());</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"["</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"(%.6f,%.6f)"</span>, sol[i].x, sol[i].y);</span><br><span class="line">        <span class="keyword">if</span>(cnt == <span class="number">2</span> &amp;&amp; !i) <span class="built_in">printf</span>(<span class="string">","</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"]"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//给定两个向量，求两向量方向内夹着的圆的圆心。圆与两线均相切，圆的半径已给定；求圆</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CircleTangentToTwoLinesWithRadius</span><span class="params">(Point A, Point B, Point C, Point D, <span class="keyword">double</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Vector AB = B - A;</span><br><span class="line">    Vector change = Normal(AB) * r;</span><br><span class="line">    Point newA1 = A + change;</span><br><span class="line">    Point newA2 = A - change;</span><br><span class="line">    Vector CD = D - C;</span><br><span class="line">    Vector update = Normal(CD) * r;</span><br><span class="line">    Point newC1 = C + update;</span><br><span class="line">    Point newC2 = C - update;</span><br><span class="line">    Point p[<span class="number">5</span>];</span><br><span class="line">    p[<span class="number">0</span>] = getLineCircleIntersecion(newA1, AB, newC1, CD);</span><br><span class="line">    p[<span class="number">1</span>] = getLineCircleIntersecion(newA1, AB, newC2, CD);</span><br><span class="line">    p[<span class="number">2</span>] = getLineCircleIntersecion(newA2, AB, newC1, CD);</span><br><span class="line">    p[<span class="number">3</span>] = getLineCircleIntersecion(newA2, AB, newC2, CD);</span><br><span class="line">    sort(p, p + <span class="number">4</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"["</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"(%.6f,%.6f)"</span>, p[<span class="number">0</span>].x, p[<span class="number">0</span>].y);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">",(%.6f,%.6f)"</span>, p[i].x, p[i].y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"]"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//给定两相离圆，求与这个两圆同时外切的圆</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CircleTangentToTwoDisjointCirclesWithRadius</span><span class="params">(Circle C1, Circle C2, <span class="keyword">double</span> r)</span></span>&#123;</span><br><span class="line">    Vector CC = C2.c - C1.c;</span><br><span class="line">    <span class="keyword">double</span> rdist = Length(CC);</span><br><span class="line">    <span class="keyword">if</span>(dcmp(<span class="number">2</span> * r - rdist + C1.r + C2.r) &lt; <span class="number">0</span>) <span class="built_in">puts</span>(<span class="string">"[]"</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(dcmp(<span class="number">2</span> * r - rdist + C1.r + C2.r) == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">double</span> ang = angle(CC);</span><br><span class="line">        Point A = C1.point(ang);</span><br><span class="line">        Point B = C2.point(ang + pi);</span><br><span class="line">        Point ret = (A + B) / <span class="number">2</span>;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"[(%.6f,%.6f)]\n"</span>, ret.x, ret.y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        Circle A = Circle(C1.c, C1.r + r);</span><br><span class="line">        Circle B = Circle(C2.c, C2.r + r);</span><br><span class="line">        <span class="built_in">vector</span>&lt;Point&gt; sol;</span><br><span class="line">        sol.clear();</span><br><span class="line">        getCircleCircleIntersection(A, B, sol);</span><br><span class="line">        sort(sol.begin(), sol.end());</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"[(%.6f,%.6f),(%.6f,%.6f)]\n"</span>, sol[<span class="number">0</span>].x, sol[<span class="number">0</span>].y, sol[<span class="number">1</span>].x, sol[<span class="number">1</span>].y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//三边构成三角形的判定</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check_length</span><span class="params">(<span class="keyword">double</span> a, <span class="keyword">double</span> b, <span class="keyword">double</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> dcmp(a+b-c) &gt; <span class="number">0</span> &amp;&amp; dcmp(<span class="built_in">fabs</span>(a-b)-c) &lt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isTriangle</span><span class="params">(<span class="keyword">double</span> a, <span class="keyword">double</span> b, <span class="keyword">double</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> check_length(a, b, c) &amp;&amp; check_length(a, c, b) &amp;&amp; check_length(b, c, a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//点在三角形内部</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cross</span><span class="params">(<span class="keyword">const</span> Point &amp;a, <span class="keyword">const</span> Point &amp;b, <span class="keyword">const</span> Point &amp;p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (b.x - a.x)*(p.y - a.y) - (b.y - a.y)*(p.x - a.x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">toLeft</span><span class="params">(<span class="keyword">const</span> Point &amp;a, <span class="keyword">const</span> Point &amp;b, <span class="keyword">const</span> Point &amp;p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> cross(a, b, p) &gt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">inTriangle</span><span class="params">(<span class="keyword">const</span> Point &amp;p, <span class="keyword">const</span> Point &amp;a, <span class="keyword">const</span> Point &amp;b, <span class="keyword">const</span> Point &amp;c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> res = toLeft(a, b, p);</span><br><span class="line">    <span class="keyword">if</span> (res != toLeft(b, c, p))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (res != toLeft(c, a, p))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (cross(a, b, c) == <span class="number">0</span>)    <span class="comment">//ABC is in one line</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;Point&gt; Polygon;</span><br><span class="line"></span><br><span class="line"><span class="comment">//平行四边形的判定（保证四边形顶点按顺序给出）</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isParallelogram</span><span class="params">(Polygon p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dcmp(Length(p[<span class="number">0</span>]-p[<span class="number">1</span>]) - Length(p[<span class="number">2</span>]-p[<span class="number">3</span>])) || dcmp(Length(p[<span class="number">0</span>]-p[<span class="number">3</span>]) - Length(p[<span class="number">2</span>]-p[<span class="number">1</span>]))) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    Line a = Line(p[<span class="number">0</span>], p[<span class="number">1</span>]-p[<span class="number">0</span>]);</span><br><span class="line">    Line b = Line(p[<span class="number">1</span>], p[<span class="number">2</span>]-p[<span class="number">1</span>]);</span><br><span class="line">    Line c = Line(p[<span class="number">3</span>], p[<span class="number">2</span>]-p[<span class="number">3</span>]);</span><br><span class="line">    Line d = Line(p[<span class="number">0</span>], p[<span class="number">3</span>]-p[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">return</span> dcmp(a.ang - c.ang) == <span class="number">0</span> &amp;&amp; dcmp(b.ang - d.ang) == <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//梯形的判定</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isTrapezium</span><span class="params">(Polygon p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Line a = Line(p[<span class="number">0</span>], p[<span class="number">1</span>]-p[<span class="number">0</span>]);</span><br><span class="line">    Line b = Line(p[<span class="number">1</span>], p[<span class="number">2</span>]-p[<span class="number">1</span>]);</span><br><span class="line">    Line c = Line(p[<span class="number">3</span>], p[<span class="number">2</span>]-p[<span class="number">3</span>]);</span><br><span class="line">    Line d = Line(p[<span class="number">0</span>], p[<span class="number">3</span>]-p[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">return</span> (dcmp(a.ang - c.ang) == <span class="number">0</span> &amp;&amp; dcmp(b.ang - d.ang)) || (dcmp(a.ang - c.ang) &amp;&amp; dcmp(b.ang - d.ang) == <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//菱形的判定</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isRhombus</span><span class="params">(Polygon p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!isParallelogram(p)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> dcmp(Length(p[<span class="number">1</span>]-p[<span class="number">0</span>]) - Length(p[<span class="number">2</span>]-p[<span class="number">1</span>])) == <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//矩形的判定</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isRectangle</span><span class="params">(Polygon p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!isParallelogram(p)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> dcmp(Length(p[<span class="number">2</span>]-p[<span class="number">0</span>]) - Length(p[<span class="number">3</span>]-p[<span class="number">1</span>])) == <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//正方形的判定</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isSquare</span><span class="params">(Polygon p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> isRectangle(p) &amp;&amp; isRhombus(p);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//三点共线的判定</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isCollinear</span><span class="params">(Point A, Point B, Point C)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> dcmp(Cross(B-A, C-B)) == <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//点在多边形内的判定</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">isPointInPolygon</span><span class="params">(Point p, Polygon poly)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> wn = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> n = poly.size();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(OnSegment(p, poly[i], poly[(i+<span class="number">1</span>)%n])) <span class="keyword">return</span> <span class="number">-1</span>; <span class="comment">//在边界上</span></span><br><span class="line">        <span class="keyword">int</span> k = dcmp(Cross(poly[(i+<span class="number">1</span>)%n]-poly[i], p-poly[i]));</span><br><span class="line">        <span class="keyword">int</span> d1 = dcmp(poly[i].y - p.y);</span><br><span class="line">        <span class="keyword">int</span> d2 = dcmp(poly[(i+<span class="number">1</span>)%n].y - p.y);</span><br><span class="line">        <span class="keyword">if</span>(k &gt; <span class="number">0</span> &amp;&amp; d1 &lt;= <span class="number">0</span> &amp;&amp; d2 &gt; <span class="number">0</span>) wn++;</span><br><span class="line">        <span class="keyword">if</span>(k &lt; <span class="number">0</span> &amp;&amp; d2 &lt;= <span class="number">0</span> &amp;&amp; d1 &gt; <span class="number">0</span>) wn--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(wn != <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;       <span class="comment">//内部</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;                   <span class="comment">//外部</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//凸包</span></span><br><span class="line">凸包的点数位ch.size();</span><br><span class="line"><span class="built_in">vector</span>&lt;Point&gt; ConvexHull(<span class="built_in">vector</span>&lt;Point&gt; p)</span><br><span class="line">&#123;</span><br><span class="line">    sort(p.begin(), p.end());</span><br><span class="line">    p.erase(unique(p.begin(), p.end()), p.end());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> n = p.size();</span><br><span class="line">    <span class="keyword">int</span> m = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">vector</span>&lt;Point&gt; ch(n+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(m &gt; <span class="number">1</span> &amp;&amp; Cross(ch[m<span class="number">-1</span>]-ch[m<span class="number">-2</span>], p[i]-ch[m<span class="number">-2</span>]) &lt;= <span class="number">0</span>) m--;</span><br><span class="line">        ch[m++] = p[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> k = m;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = n<span class="number">-2</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(m &gt; k &amp;&amp; Cross(ch[m<span class="number">-1</span>]-ch[m<span class="number">-2</span>], p[i]-ch[m<span class="number">-2</span>]) &lt;= <span class="number">0</span>) m--;</span><br><span class="line">        ch[m++] = p[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(m &gt; <span class="number">1</span>) m--;</span><br><span class="line">    ch.resize(m);</span><br><span class="line">    <span class="keyword">return</span> ch;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//点P在有向直线L左边的判定(线上不算)</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">OnLeft</span><span class="params">(<span class="keyword">const</span> Line&amp; L, <span class="keyword">const</span> Point&amp; P)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Cross(L.v, P-L.P) &gt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//两直线交点，假定交点唯一存在</span></span><br><span class="line"><span class="function">Point <span class="title">GetIntersection</span><span class="params">(Line a, Line b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Vector u = a.P - b.P;</span><br><span class="line">    <span class="keyword">double</span> t = Cross(b.v, u) / Cross(a.v, b.v);</span><br><span class="line">    <span class="keyword">return</span> a.P+a.v*t;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> t;</span><br><span class="line"><span class="keyword">double</span> x,y,r;</span><br><span class="line"><span class="keyword">double</span> x_1,y_1,x_2,y_2;</span><br><span class="line"><span class="keyword">double</span> x_3,y_3,x_4,y_4;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

            

        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">标签</span><br>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/算法/">算法</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/posts/18031/" data-tooltip="更高级的模板" aria-label="上一篇: 更高级的模板">
                
                    <i class="fa fa-angle-left" aria-hidden="true"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">上一篇</span>
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/posts/33256/" data-tooltip="动态规划模板" aria-label="下一篇: 动态规划模板">
                
                    <span class="hide-xs hide-sm text-small icon-mr">下一篇</span>
                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="分享">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://www.jelech.cn/posts/56449/" title="分享到 Facebook">
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://www.jelech.cn/posts/56449/" title="分享到 Twitter">
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://www.jelech.cn/posts/56449/" title="分享到 Google+">
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#table-of-contents" aria-label="目录">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
                <style media="screen">.v .vwrap{overflow: inherit;}</style>
                <div id="vcomment"></div>
                <a href="posts/56449/#vcomment" class="disqus-comment-count"></a>
                <span class="valine-comment-count" data-xid="posts/56449/"></span>
                <span> Comment</span>
            
        
    </div>
</article>


                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2018 Jelech. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/posts/18031/" data-tooltip="更高级的模板" aria-label="上一篇: 更高级的模板">
                
                    <i class="fa fa-angle-left" aria-hidden="true"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">上一篇</span>
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/posts/33256/" data-tooltip="动态规划模板" aria-label="下一篇: 动态规划模板">
                
                    <span class="hide-xs hide-sm text-small icon-mr">下一篇</span>
                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="分享">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://www.jelech.cn/posts/56449/" title="分享到 Facebook">
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://www.jelech.cn/posts/56449/" title="分享到 Twitter">
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://www.jelech.cn/posts/56449/" title="分享到 Google+">
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#table-of-contents" aria-label="目录">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                <div id="share-options-bar" class="share-options-bar" data-behavior="4">
    <i id="btn-close-shareoptions" class="fa fa-times"></i>
    <ul class="share-options">
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://www.jelech.cn/posts/56449/">
                    <i class="fab fa-facebook" aria-hidden="true"></i><span>分享到 Facebook</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=http://www.jelech.cn/posts/56449/">
                    <i class="fab fa-twitter" aria-hidden="true"></i><span>分享到 Twitter</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=http://www.jelech.cn/posts/56449/">
                    <i class="fab fa-google-plus" aria-hidden="true"></i><span>分享到 Google+</span>
                </a>
            </li>
        
    </ul>
</div>

            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/avatar.jpg" alt="作者的图片">
        
            <h4 id="about-card-name">Jelech</h4>
        
            <div id="about-card-bio"><p>putty本无树,MinGW亦非台</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br>
                <p>在校大学生一枚</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br>
                CHINA.HRB.STU
            </div>
        

        
            <div id="about-card-job">
                <i class="fa fa-envelope"></i>
                <br>
                jelech@hotmail.com
            </div>
        

        
            <div id="about-card-job">
                <i class="fa fa-phone-square"></i>
                <br>
                18.......6
            </div>
        


    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/script-vufjrm3fmbuttogo1hxuu0w9w0sesk5iyysjuguc2hdhufot9szxg8twijry.min.js"></script>
<!--SCRIPTS END-->

    
        
        <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js" charset="utf-8"></script>
        <script src="//unpkg.com/valine@latest/dist/Valine.min.js" charset="utf-8"></script>
        <script>
            var notify = 'false' == true ? true : false;
            var verify = 'false' == true ? true : false;
            var GUEST_INFO = ['nick','mail','link'];
            var guest_info = 'nick,mail,link'.split(',').filter(function(item){
                return GUEST_INFO.indexOf(item) > -1;
            });

            guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
            window.valine = new Valine({
                el:'#vcomment',
                notify:notify,
                verify:verify,
                appId:'rwwVeUe3kpfbc0OkoxmgnTKM-gzGzoHsz',
                appKey:'FcDDW6bpbs5QmH3A1B2Aqmae',
                placeholder:'Just so so',
                avatar:'mm',
                guest_info:guest_info,
                pageSize:'10'
            });
        </script>
    



    </body>
</html>
